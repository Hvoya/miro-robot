(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-32cfbf76"],{"0a37":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ProjectPageTemplate",[i("h2",{domProps:{innerHTML:e._s(e.$t(e.isEditView?"headings.edit_project":"headings.new_project"))}}),i("a-card",[i("div",{staticClass:"files-container"},[i("a-row",{attrs:{gutter:20}},[i("a-col",{attrs:{span:13}},[i("div",{staticClass:"images"},[i("h4",[e._v(e._s(e.$t("headings.upload_images")))]),i("a-upload",{attrs:{"before-upload":e.beforeUpload,fileList:e.imageList,action:"/api/images",listType:"picture-card",remove:e.handleImageRemove},on:{preview:e.handlePreview,change:e.handleChange}},[i("div",[i("a-icon",{attrs:{type:"plus"}}),i("div",{staticClass:"ant-upload-text"},[e._v(e._s(e.$t("buttons.upload")))])],1)])],1)]),i("a-col",{attrs:{span:10}},[i("div",{staticClass:"documents"},[i("h4",[e._v(e._s(e.$t("headings.attach_files")))]),i("a-upload",{attrs:{beforeUpload:e.beforeUpload,remove:e.handleFileRemove,fileList:e.fileList,action:"/api/files"},on:{change:e.handleFilesChange}},[i("a-button",[i("a-icon",{attrs:{type:"upload"}}),e._v("\n                "+e._s(e.$t("buttons.attach"))+"\n              ")],1)],1)],1)])],1)],1),i("div",{staticClass:"text-container"},[i("a-form",{attrs:{form:e.form},on:{submit:e.handleSubmit}},[e.imageList.length>0?i("a-form-item",{attrs:{label:e.$t("form_labels.main_image_id"),wrapperCol:{span:12},labelCol:{span:24}}}):e._e(),i("a-form-item",{attrs:{label:e.$t("form_labels.project_name"),wrapperCol:{span:12},labelCol:{span:24}}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["heading",{rules:[{required:!0,message:e.$t("form_errors.required")}]}],expression:"[\n              'heading',\n              {rules: [{ required: true, message: $t('form_errors.required') }]}\n              ]"}]})],1),i("a-form-item",{attrs:{label:e.$t("form_labels.project_description")}},[i("quill-editor",{model:{value:e.description,callback:function(t){e.description=t},expression:"description"}})],1),i("a-row",{attrs:{type:"flex",justify:"center"}},[i("a-button",{attrs:{type:"primary","html-type":"submit"}},[e._v("\n              "+e._s(e.isEditView?e.$t("buttons.edit_project"):e.$t("buttons.create_project"))+"\n          ")])],1)],1)],1)]),i("a-modal",{attrs:{visible:e.previewVisible,footer:null},on:{cancel:e.handleCancel}},[i("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:e.previewImage}})]),i("a-modal",{attrs:{visible:e.noImageModalVisible},on:{ok:e.createProject,cancel:e.handleCancel}},[e._v(e._s(e.$t("modals.creation_project_with_no_images")))])],1)},s=[],r=(i("7f7f"),i("6762"),i("2fdb"),i("953d")),n=i("1c1e"),o=i("01eb"),l=(i("a753"),i("8096"),i("14e1"),{components:{ProjectPageTemplate:o["a"],quillEditor:r["quillEditor"]},data:function(){return{previewVisible:!1,noImageModalVisible:!1,isEditView:!1,previewImage:"",imageList:[],fileList:[],form:this.$form.createForm(this),description:""}},methods:{handleCancel:function(){this.previewVisible=!1},handlePreview:function(e){this.previewImage=e.url||e.thumbUrl,this.previewVisible=!0},handleChange:function(e){var t=e.fileList,i=e.file;i.size/1024/1024>2||(this.imageList=t)},handleFilesChange:function(e){var t=e.file,i=e.fileList;t.size/1024/1024>2||(this.fileList=i)},handleSubmit:function(e){e.preventDefault(),this.isEditView?this.editProject():0!==this.imageList.length?this.createProject():this.noImageModalVisible=!0},editProject:function(){var e=this;this.noImageModalVisible=!1,this.form.validateFields(function(t,i){if(!t){var a=e.imageList.map(function(e){return e.response?e.response.data.id:e.uid}),s=e.fileList.map(function(e){return e.response?e.response.data.id:e.uid});n["a"].put("/projects/"+e.$route.params.id,{name:i.heading,description:e.description,images:a,files:s,main_image_id:a.length>0?a[i.main_image_number-1]:null}).then(function(t){e.$message.success(e.$t("success.project_saved")),e.$router.push("/projects/"+e.$route.params.id)}).catch(function(){e.$message.error(e.$t("errors.server_error"))})}})},createProject:function(){var e=this;this.noImageModalVisible=!1,this.form.validateFields(function(t,i){if(!t){var a=e.imageList.map(function(e){return e.response.data.id}),s=e.fileList.map(function(e){return e.response.data.id});n["a"].post("/projects",{name:i.heading,description:e.description,images:a,files:s,main_image_id:a.length>0?a[i.main_image_number-1]:null}).then(function(t){e.$message.success(e.$t("success.project_created")),e.$router.push("/projects")}).catch(function(){e.$message.error(e.$t("errors.server_error"))})}})},handleImageRemove:function(e){var t=e.response?e.response.data.id:e.uid;n["a"].del("/images/"+t)},handleFileRemove:function(e){var t=e.response?e.response.data.id:e.uid;n["a"].del("/files/"+t)},beforeUpload:function(e){var t=e.size/1024/1024<2;return t||this.$message.error(this.$t("errors.max_file_size")),t}},mounted:function(){var e=this;this.$route.path.includes("edit")&&(this.isEditView=!0,n["a"].get("/projects/".concat(this.$route.params.id).concat(this.$store.state.user?"?user_id=".concat(this.$store.state.user.id):"")).then(function(t){e.form.setFieldsValue({heading:t.data.name}),e.description=t.data.description,e.project=t.data,e.imageList=t.data.images.map(function(e){return{uid:e.id,status:"done",url:"/api/images/"+e.name}}),e.fileList=t.data.files.map(function(e){return{uid:e.id,name:e.original_name,status:"done",url:"/api/files/"+e.id}})}))}}),c=l,d=(i("0d80"),i("2877")),u=Object(d["a"])(c,a,s,!1,null,"c1de9c22",null);t["default"]=u.exports},"0d80":function(e,t,i){"use strict";var a=i("fea7"),s=i.n(a);s.a},"7f7f":function(e,t,i){var a=i("86cc").f,s=Function.prototype,r=/^\s*function ([^ (]*)/,n="name";n in s||i("9e1e")&&a(s,n,{configurable:!0,get:function(){try{return(""+this).match(r)[1]}catch(e){return""}}})},fea7:function(e,t,i){}}]);
//# sourceMappingURL=chunk-32cfbf76.95f68fc3.js.map